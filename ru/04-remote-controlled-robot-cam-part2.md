WebIOPi - Фреймворк REST для Raspberry Pi

Роботизированная камера с удалённым управлением, Часть II

Eric PTAK
Guest Writer

УРОВЕНЬ СЛОЖНОСТИ: ПРОДВИНУТЫЙ

Построение интерфейса
---------------------

Написать интерфейс - тоже простая задача, и решается HTML файлом со встроенным Javascript. 
Чтобы использовать возможности WebIOPi, необходимо всего лишь включить файл `webiopi.js` в документ HTML.
Создайте новый файл `index.html` рядом со сценарием Python:

    <html>
      <head>
      <title>CamBot</title>
      <script type="text/javascript" src="/webiopi.js"></script>
      <script type="text/javascript">
      // Код Javascript будет здесь
      </script>
      </head>
      <body>
        <div id="box" align="center">
        </div>
      </body>
    </html>

Обратите внимание на начальный слэш при подключении webiopi.js, он указывает на то,
что файл нужно искать в корне сервера - иначе он может и не подгрузиться.
Я добавил пустую секцию `script`, в ней мы запишем вызовы к библиотеке WebIOPi.
Также есть контейнер `div`, который будет содержать элементы управления.

В секции `script` мы записываем интерфейсную функцию `init()`.
WebIOPi содержит множество функций для упрощения создания кнопок управления GPIO.
Здесь мы используем простой вызов `createButton`, чтобы различать нажатие и отпускание кнопки.
Каждая функция вызывает свою макропоследовательность на сервере.
Не забудьте зарегистрировать функцию `init()` в WebIOPi.
Она будет выполнена как только всё загрузится и будет готово.

    function init() {
      var button =
      webiopi().createButton(
        "bt_up" ,    // идентификатор
        "/\\" ,      // надпись
        go_forward,  // обработчик нажатия
        stop);       // обработчик отпускания
        $("#box" ).append(button);
    }

[page05]

Будьте внимательны: `webiopi()` является функцией и зарезервированным словом. 
Скобки нужно записывать обязаательно, чтобы она могла вернуть объект WebIOPi.
Для сокращения можно использовать просто `w()`.

Самое время запустить сервер и полюбоваться на интерфйс.
Откройте терминал в том каталоге, где вы создали сценария Python и HTML файл, и выполните команду:

    $ sudo python yourscript.py

